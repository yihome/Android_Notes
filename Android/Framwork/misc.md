## 简介

在Linux系统下设备都是以文件的形式存在，应用程序可以打开、关闭和读写这些设备文件，完成对设备的操作，就像操作普通的数据文件一样，这些文件统一存放在`/dev/`目录下。

为了管理设备，系统为设备设置了编号，编号又分为主设备号和次设备号，最初主设备号用于表示指定的设备驱动，次设备号用于表示特定的设备。但是现在多个驱动也可以共享一个主设备号。（设备号可以通过ll或者ls -all的命令查看）

`misc` 是linux下定义的主设备号为10的设备,它是一些没有归类简单字符设备的集合,这些设备使用共同的主设备号，通过从设备号进行区别。

## Android下的使用

通过 `cat /proc/misc` 我们可以看到已经注册的 `misc` 设备，在模拟器上运行这个命令，我们可以看到几个熟悉的身影

* `binder` 
* `ashmem` 
* `log`

这些机制在底层都是通过 `misc` 驱动来完成的。但是为什么呢？

* 驱动程序运行在内核态，我们可以通过 `open` , `mmap` , `ioctl` 进入到内核态，调用相应的驱动程序代码，完成部分在内核空间才能进行的操作



## 使用

通过 `misc` 提供的函数，我们不需要自己手动创建设备节点，可以更简单的实现设备驱动。它主要方法有两个

* `extern int misc_register(struct miscdevice * misc);` 注册 `misc` 设备
* `extern int misc_deregister(struct miscdevice *misc);`  注销`misc` 设备